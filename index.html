<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Guru Wali-Abu-Abu Kuning</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* ====================================
           GAYA UMUM & TATA LETAK (Desktop Default)
           ==================================== */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #eef1f6;
            margin: 0;
            padding: 30px; 
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .card-container {
            width: 100%;
            max-width: 650px;
            background-color: #ffffff;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            padding: 35px 45px; 
            box-sizing: border-box;
            border-top: 5px solid #4a90e2;
            position: relative; 
        }
        
        .header-kop {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ddd;
        }
        
        .header-kop img {
            width: 100%; 
            max-width: 100%;
            height: auto;
            border-radius: 8px; 
            opacity: 0.95;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        h2 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 15px; 
            padding-bottom: 15px;
            position: relative;
            font-size: 1.8em; 
            font-weight: 700;
        }

        h2::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: 0;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background-color: #4a90e2;
            border-radius: 2px;
        }

        /* CONTAINER PENCARIAN */
        .search-container {
            margin: 5px 0 0 0; 
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .input-group {
            display: flex; 
            align-items: center;
            position: relative;
        }
        
        .nis-input {
            width: 150px; 
            max-width: 150px; 
            padding: 8px 10px; 
            border: 2px solid #ccc;
            border-radius: 8px 0 0 8px; 
            font-size: 1em; 
            color: #333;
            transition: all 0.3s ease;
            box-sizing: border-box;
            outline: none;
            text-align: center; 
            height: 38px; 
        }

        .nis-input:focus {
            border-color: #4a90e2;
            box-shadow: 0 0 0 4px rgba(74, 144, 226, 0.4); 
            z-index: 10; 
        }

        .nis-input::placeholder {
            color: #999; 
            font-style: italic;
            font-size: 0.9em;
        }
        
        .search-button {
            background-color: #4a90e2; 
            color: white;
            border: none;
            padding: 8px 10px; 
            margin-left: -2px; 
            cursor: pointer;
            border-radius: 0 8px 8px 0; 
            font-size: 0.8em; 
            font-weight: 600;
            height: 38px; 
            transition: background-color 0.2s;
            box-sizing: border-box;
            z-index: 5; 
            
            position: relative; 
            overflow: hidden;
            width: 55px; 
        }

        .search-button:hover {
            background-color: #367ac8; 
        }

        /* PESAN STATUS (Default Desktop) */
        #message {
            text-align: center;
            color: #e74c3c; 
            font-weight: 600; 
            margin: 10px 0 15px 0;
            min-height: 1.2em; 
        }

        /* OVERLAY LOADING BARU (Mencakup seluruh Card) */
        #fullLoadingOverlay {
            display: none; 
            position: absolute; 
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 999; 
            
            background-color: rgba(255, 255, 255, 0.55); 
            
            justify-content: center;
            align-items: center; 
            flex-direction: column;
            
            border-radius: 16px; 
            
            backdrop-filter: blur(4px); 
            -webkit-backdrop-filter: blur(4px);
        }
        
        #dataLoadingSpinner {
            color: #4a90e2; 
            font-size: 2.5em; 
            animation: spin 1.5s linear infinite; 
            z-index: 1000;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* PENGATURAN TABEL (Desktop) */
        .data-table {
            width: 100%;
            border-collapse: collapse; 
            border-spacing: 0; 
            margin-top: 20px;
        }

        .data-table tr {
            display: flex; 
            align-items: stretch; 
            margin-bottom: 5px; 
            gap: 5px; 
            width: 100%;
        }
        
        /* Gaya Kolom Judul dan Data (Desktop Default) */
        .data-table th, .data-table td {
            border: 0 !important; 
            padding: 0; 
            flex-grow: 1; 
            box-sizing: border-box;
            height: auto; 
        }

        .data-table th {
            width: 40%; 
            flex-basis: 40%;
            flex-shrink: 0;
        }
        
        .data-table td {
            width: 60%; 
            flex-basis: 60%;
            flex-shrink: 0;
        }

        .header-content {
            background-color: #eaf3ff; 
            color: #2c3e50;
            padding: 15px; 
            display: flex; 
            align-items: center; 
            height: 100%; 
            box-sizing: border-box;
            font-weight: 600;
            justify-content: flex-start; 
            font-size: 1em; 
        }
        
        .data-content {
            background-color: #f5f5f5; 
            padding: 15px 20px 15px 15px; 
            height: 100%; 
            box-sizing: border-box;
            font-weight: 500;
            text-align: left; 
            
            display: flex;
            align-items: center; 
        }

        .data-content.data-content-filled {
            background-color: #fffae0; 
        }
        
        /* Gaya Teks */
        .highlighted-name {
            font-size: clamp(0.8em, 4vw, 1.25em); 
            color: #2c3e50; 
            font-weight: 800 !important; 
        }

        .highlighted-wali {
            font-weight: 500 !important; 
            font-size: 1em;
        }
        
        /* ====================================
           GAYA FOOTER BARU
           ==================================== */
        .page-footer {
            /* Jarak standar/normal dari kartu konten utama */
            margin-top: 50px; 
            padding: 10px 10px;
            text-align: center;
            font-size: 0.9em; /* Ukuran font standar desktop */
            color: #2c3e50; /* Hitam soft (dark grey) */
            line-height: 1.8; /* Jarak antar baris agar rapi */
        }
        
        .footer-line {
            display: block; /* Memastikan setiap baris bersusun */
        }

        .footer-line a, .footer-line strong {
            color: #2c3e50; /* Memastikan teks footer hitam */
            font-weight: 500;
        }

        /* Pewarnaan khusus untuk 'Andizzu|L' */
        .highlight-blue {
            color: #4a90e2; /* Biru lembut, tidak terlalu terang */
            font-weight: 600;
            text-decoration: none; 
        }


        /* ====================================
           PENYESUAIAN MOBILE (HP) - LOCKED
           ==================================== */
        @media (max-width: 768px) {
            body {
                padding: 0;
                align-items: stretch;
            }
            
            .card-container {
                border-radius: 0; 
                /* Padding disesuaikan untuk memperbesar visual kop (5px horizontal) */
                padding: 11px 5px; 
                box-shadow: none; 
                max-width: 100%;
                width: 100%;
            }
            
            h2 {
                font-size: 1.1em; 
            }

            /* LOCKED: Font Size Pesan Keterangan 0.8em */
            #message {
                font-size: 0.8em; 
                font-weight: normal; 
                text-align: center; 
            }

            /* LOCKED: Kerapihan Kolom (Judul 28%, Data 72%) */
            .data-table th {
                flex-basis: 28%; 
                width: 28%; 
            }
            
            .data-table td {
                flex-basis: 72%; 
                width: 72%;
                font-size: 0.9em; 
            }

            /* PERBAIKAN VERTICAL CENTER HP */
            .data-content {
                display: flex; 
                align-items: center; 
            }

            /* LOCKED: Ukuran Font Judul 0.85em */
            .header-content {
                font-size: 0.85em; 
                justify-content: flex-start; 
            }
            
            /* LOCKED: Rata Kiri Wajib untuk Teks Judul */
            .header-content span {
                text-align: left !important;
                display: block; 
            }
            
            /* Rata Kiri Semua Data */
            .highlighted-name,
            .highlighted-wali,
            .data-content {
                text-align: left !important;
            }

            /* Menghilangkan ikon di tampilan mobile */
            .header-content i {
                display: none; 
            }
            
            /* LOCKED: Border-radius gambar 0 untuk mobile */
            .header-kop img {
                border-radius: 0; 
            }

            /* LOCKED: Posisi Spinner dipertahankan */
            #fullLoadingOverlay {
                border-radius: 0; 
                top: 0;
                height: 100%; 
            }
            
            #dataLoadingSpinner {
                transform: translateY(-20vh) rotate(0deg); 
            }
            
            /* LOCKED: Warna dan Padding Kolom */
            .header-content {
                background-color: #eaf3ff; 
                padding: 10px; 
            }
            .data-content {
                background-color: #f5f5f5;
                padding: 10px; 
            }
            .data-content.data-content-filled {
                background-color: #fffae0; 
            }
            
            /* Penyesuaian Footer di Mobile (HP) */
            .page-footer {
                /* Jarak proporsional di HP */
                margin-top: 30px; 
                padding: 10px 5px;
                font-size: 0.8em; /* Ukuran font proporsional HP */
                line-height: 1.5;
            }
        }
    </style>
</head>
<body>

<div class="card-container">
    
    <div id="fullLoadingOverlay">
        <i class="fas fa-circle-notch" id="dataLoadingSpinner"></i>
    </div>
    
    <div class="header-kop">
        <img src="kopsekolah.jpg" alt="Kop Surat Sekolah"> 
    </div>
    
    <h2>Data Murid dan Guru Wali</h2>
    
    <div class="search-container">
        
        <div class="input-group">
            <input type="text" id="nisSearch" class="nis-input" 
                   placeholder="Input NIS" 
                   aria-label="Cari data murid berdasarkan NIS">
            
            <button id="searchButton" class="search-button">
                <span class="search-text">Cari</span> 
            </button>
        </div>
    </div>

    <div id="message"></div>
    
    <div id="dataResult">
        <table class="data-table">
            <tr>
                <th><div class="header-content"><span><i class="fas fa-user"></i> Nama Lengkap</span></div></th>
                <td><div id="namaLengkap" class="data-content highlighted-name">-</div></td>
            </tr>
            <tr>
                <th><div class="header-content"><span><i class="fas fa-school"></i> Kelas</span></div></th>
                <td><div id="kelas" class="data-content">-</div></td>
            </tr>
            <tr>
                <th><div class="header-content"><span><i class="fas fa-id-card"></i> NIS</span></div></th>
                <td><div id="nis" class="data-content">-</div></td>
            </tr>
            <tr>
                <th><div class="header-content"><span><i class="fas fa-id-badge"></i> NISN</span></div></th>
                <td><div id="nisn" class="data-content">-</div></td>
            </tr>
            <tr>
                <th><div class="header-content"><span><i class="fas fa-venus-mars"></i> Jenis Kelamin</span></div></th>
                <td><div id="jenisKelamin" class="data-content">-</div></td>
            </tr>
            <tr>
                <th><div class="header-content"><span><i class="fas fa-map-marker-alt"></i> Alamat</span></div></th>
                <td><div id="alamat" class="data-content">-</div></td>
            </tr>
            <tr>
                <th><div class="header-content"><span><i class="fas fa-user-tie"></i> Wali Kelas</span></div></th>
                <td><div id="waliKelas" class="data-content highlighted-wali">-</div></td>
            </tr>
            <tr>
                <th><div class="header-content"><span><i class="fas fa-chalkboard-teacher"></i> Guru Wali</span></div></th>
                <td><div id="guruWali" class="data-content highlighted-wali">-</div></td>
            </tr>
        </table>
    </div>
</div>
<footer class="page-footer">
    <span class="footer-line">Guru Wali - SMP Negeri 1 Bulukumba</span>
    <span class="footer-line">Developed By : <span class="highlight-blue">Andizzu|L</span></span>
    <span class="footer-line">2025</span>
</footer>
<script>
    // =========================================================================
    // KODE JAVASCRIPT (KONEKSI GOOGLE SHEET)
    // =========================================================================
    // PASTIKAN Anda GANTI ID dan NAMA SHEET ini sesuai dengan Google Sheet Anda
    const SHEET_ID = '1_ldkkmwrLwZhw8UK0dWu3JZjBCe3vY6WGK_Dnhe3ghY'; 
    const SHEET_NAME = 'guru_wali'; 
    
    const nisInput = document.getElementById('nisSearch');
    const searchButton = document.getElementById('searchButton'); 
    const messageDiv = document.getElementById('message'); 
    const fullLoadingOverlay = document.getElementById('fullLoadingOverlay'); 
    const dataResult = document.getElementById('dataResult');
    
    const DISPLAY_DELAY_MS = 2000; 

    function resetDisplay() {
        document.querySelectorAll('#dataResult .data-content').forEach(div => {
            div.classList.remove('data-content-filled'); 
        }); 
        
        document.getElementById('namaLengkap').innerText = '-';
        document.getElementById('kelas').innerText = '-';
        document.getElementById('nis').innerText = '-';
        document.getElementById('nisn').innerText = '-';
        document.getElementById('jenisKelamin').innerText = '-';
        document.getElementById('alamat').innerText = '-';
        document.getElementById('waliKelas').innerText = '-'; 
        document.getElementById('guruWali').innerText = '-';
    }
    
    function setButtonLoading(isLoading) {
        if (isLoading) {
            fullLoadingOverlay.style.display = 'flex'; 
            searchButton.disabled = true; 
            nisInput.disabled = true; 
        } else {
            fullLoadingOverlay.style.display = 'none'; 
            searchButton.disabled = false; 
            nisInput.disabled = false; 
        }
    }


    document.addEventListener('DOMContentLoaded', function() {
        resetDisplay();
        
        searchButton.addEventListener('click', function() {
            resetDisplay(); 
            searchData();
        });
        
        nisInput.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault(); 
                resetDisplay(); 
                searchData();
            }
        });
        
        nisInput.addEventListener('input', () => {
             resetDisplay(); 
             messageDiv.innerText = ""; 
        });
    });

    function searchData() {
        const nis = nisInput.value.trim();
        if (nis.length === 0) {
            messageDiv.innerText = "Kolom NIS tidak boleh kosong.";
            setButtonLoading(false); 
            return;
        }

        messageDiv.innerText = ""; 
        setButtonLoading(true); 
        
        const query = encodeURIComponent(`SELECT B, C, D, E, F, G, H WHERE A = '${nis}'`);
        const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tq=${query}&sheet=${SHEET_NAME}&headers=1`;
        
        fetch(url)
            .then(response => response.text())
            .then(data => {
                const jsonData = extractJsonFromResponse(data);
                
                setTimeout(() => {
                    if (jsonData && jsonData.table && jsonData.table.rows && jsonData.table.rows.length > 0) {
                        const row = jsonData.table.rows[0];
                        
                        const student = {
                            nisn: row.c[0] ? row.c[0].v : '-',
                            namaLengkap: row.c[1] ? row.c[1].v : '-',
                            kelas: row.c[2] ? row.c[2].v : '-',
                            jenisKelamin: row.c[3] ? row.c[3].v : '-',
                            alamat: row.c[4] ? row.c[4].v : '-',
                            waliKelas: row.c[5] ? row.c[5].v : '-', 
                            guruWali: row.c[6] ? row.c[6].v : '-',
                            nis: nis
                        };
                        
                        displayStudentData(student);
                        messageDiv.innerText = ""; 
                    } else {
                        messageDiv.innerText = "Data tidak ditemukan."; 
                    }
                    
                    setButtonLoading(false); 
                }, DISPLAY_DELAY_MS);
            })
            .catch(error => {
                setTimeout(() => {
                    setButtonLoading(false); 
                    messageDiv.innerText = "Terjadi kesalahan koneksi. Pastikan Google Sheet sudah publik."; 
                    console.error("Terjadi kesalahan koneksi. Pastikan Google Sheet sudah publik. Error:", error);
                }, DISPLAY_DELAY_MS);
            });
    }

    function displayStudentData(student) {
        document.getElementById('namaLengkap').innerText = student.namaLengkap || '-';
        document.getElementById('kelas').innerText = student.kelas || '-';
        document.getElementById('nis').innerText = student.nis || '-';
        document.getElementById('nisn').innerText = student.nisn || '-';
        document.getElementById('jenisKelamin').innerText = student.jenisKelamin || '-';
        document.getElementById('alamat').innerText = student.alamat || '-';
        document.getElementById('waliKelas').innerText = student.waliKelas || '-';
        document.getElementById('guruWali').innerText = student.guruWali || '-';
        
        document.querySelectorAll('#dataResult .data-content').forEach(div => {
            div.classList.add('data-content-filled');
        });
    }

    function extractJsonFromResponse(response) {
        const jsonString = response.substring(response.indexOf('{'), response.lastIndexOf('}') + 1);
        try {
            return JSON.parse(jsonString);
        } catch (e) {
            console.error("Gagal mengurai JSON:", e);
            return null;
        }
    }
</script>

</body>
</html>
